<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsara Saga - The Eternal Journey</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Marcellus&family=EB+Garamond:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== PREMIUM DESIGN SYSTEM ===== */
        :root {
            /* Typography */
            --font-title: 'Cinzel', serif;
            --font-body: 'Marcellus', serif;
            --font-story: 'EB Garamond', serif;
            
            /* Color Philosophy - Based on Hindu Elements */
            --color-bg: #0a0908; /* Void - Shunya */
            --color-surface: #1a1817; /* Earth - Prithvi */
            --color-surface-elevated: #2a2624;
            --color-text: #e8e3d3; /* Light - Prakash */
            --color-text-muted: #a69b87;
            --color-text-subtle: #7a7670;
            
            /* Sacred Colors */
            --color-primary: #e09658; /* Saffron - Sacred Fire */
            --color-primary-glow: #ffc994;
            --color-primary-deep: #c17a3a;
            --color-shadow: #e09658;

            /* Guna Colors */
            --color-sattva: #63b4d1; /* Sky Blue - Pure Consciousness */
            --color-rajas: #d96c47; /* Fire Red - Dynamic Action */
            --color-tamas: #5c527f; /* Deep Purple - Potential Energy */
            --color-karma: #bca06a; /* Golden - Cosmic Law */

            /* UI States */
            --color-success: #10b981; /* Growth Green */
            --color-warning: #f59e0b; /* Caution Amber */
            --color-danger: #ef4444; /* Destruction Red */
            --color-info: #3b82f6; /* Wisdom Blue */
            --color-cosmic: #8b5cf6; /* Cosmic Purple */
            
            /* Sacred Geometry */
            --golden-ratio: 1.618;
            --border-radius: 12px;
            --border-radius-large: 20px;
            --transition-speed: 0.4s;
            --transition-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
            
            /* Spacing Scale - Based on Sacred Numbers */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 40px;
            --space-2xl: 64px;
            
            /* Shadows */
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.15);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.25);
            --shadow-strong: 0 16px 50px rgba(0, 0, 0, 0.4);
            --shadow-cosmic: 0 0 30px rgba(224, 150, 88, 0.3);
        }

        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            background: radial-gradient(ellipse at center, #1a1817 0%, var(--color-bg) 70%);
            color: var(--color-text);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            line-height: 1.6;
        }

        /* ===== IMMERSIVE COSMIC BACKGROUND ===== */
        .cosmic-environment {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .stellar-field {
            position: absolute;
            width: 200%;
            height: 200%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(224, 150, 88, 0.4), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(99, 180, 209, 0.3), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(139, 92, 246, 0.4), transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(224, 150, 88, 0.2), transparent),
                radial-gradient(2px 2px at 160px 30px, rgba(92, 82, 127, 0.3), transparent),
                radial-gradient(3px 3px at 200px 60px, rgba(224, 150, 88, 0.5), transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: stellar-drift 400s linear infinite;
        }

        @keyframes stellar-drift {
            from { transform: translateY(0px) rotate(0deg); }
            to { transform: translateY(-100px) rotate(360deg); }
        }

        .cosmic-mandala {
            position: absolute;
            width: 100%;
            height: 100%;
            background: conic-gradient(
                from 0deg at 50% 50%,
                transparent 0deg,
                rgba(224, 150, 88, 0.03) 45deg,
                transparent 90deg,
                rgba(99, 180, 209, 0.03) 135deg,
                transparent 180deg,
                rgba(139, 92, 246, 0.03) 225deg,
                transparent 270deg,
                rgba(92, 82, 127, 0.03) 315deg,
                transparent 360deg
            );
            animation: mandala-rotation 300s linear infinite;
        }

        @keyframes mandala-rotation {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .energy-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, rgba(224, 150, 88, 0.6), transparent 2px),
                radial-gradient(circle, rgba(99, 180, 209, 0.4), transparent 1px),
                radial-gradient(circle, rgba(139, 92, 246, 0.5), transparent 1px);
            background-size: 300px 300px, 450px 450px, 600px 600px;
            animation: particles-float 120s ease-in-out infinite;
        }

        @keyframes particles-float {
            0%, 100% { transform: translateY(0px) translateX(0px); }
            25% { transform: translateY(-20px) translateX(10px); }
            50% { transform: translateY(-10px) translateX(-15px); }
            75% { transform: translateY(-30px) translateX(5px); }
        }

        /* ===== PREMIUM HEADER DESIGN ===== */
        .sacred-header {
            background: linear-gradient(135deg, 
                rgba(26, 24, 23, 0.98) 0%, 
                rgba(10, 9, 8, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(224, 150, 88, 0.3);
            padding: var(--space-lg) var(--space-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-medium);
        }

        .title-mandala {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .sacred-symbol {
            width: 60px;
            height: 60px;
            border: 2px solid var(--color-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle, rgba(224, 150, 88, 0.2) 0%, transparent 70%);
            animation: symbol-pulse 4s ease-in-out infinite;
            font-size: 1.5rem;
            color: var(--color-primary);
        }

        @keyframes symbol-pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(224, 150, 88, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px rgba(224, 150, 88, 0.6); }
        }

        .game-title {
            font-family: var(--font-title);
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(45deg, 
                var(--color-primary), 
                var(--color-primary-glow), 
                var(--color-cosmic));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px var(--color-shadow);
            animation: title-illuminate 6s ease-in-out infinite alternate;
        }

        @keyframes title-illuminate {
            from { filter: drop-shadow(0 0 10px rgba(224, 150, 88, 0.5)); }
            to { filter: drop-shadow(0 0 25px rgba(224, 150, 88, 0.8)); }
        }

        .journey-badge {
            background: linear-gradient(135deg, var(--color-cosmic), var(--color-primary));
            color: white;
            padding: var(--space-sm) var(--space-md);
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: badge-glow 3s ease-in-out infinite;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        @keyframes badge-glow {
            0%, 100% { box-shadow: 0 0 15px rgba(139, 92, 246, 0.4); }
            50% { box-shadow: 0 0 25px rgba(139, 92, 246, 0.7); }
        }

        /* ===== RESPONSIVE GRID LAYOUT ===== */
        .enlightenment-container {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: var(--space-xl);
            padding: var(--space-xl);
            max-width: 1600px;
            margin: 0 auto;
            min-height: calc(100vh - 140px);
        }

        /* ===== MAIN JOURNEY PANEL ===== */
        .journey-canvas {
            background: rgba(26, 24, 23, 0.85);
            backdrop-filter: blur(25px);
            border: 2px solid rgba(224, 150, 88, 0.25);
            border-radius: var(--border-radius-large);
            padding: var(--space-2xl);
            box-shadow: 
                var(--shadow-strong),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            max-height: calc(100vh - 200px);
            position: relative;
        }

        .journey-canvas::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, 
                rgba(224, 150, 88, 0.2) 0%, 
                transparent 25%, 
                transparent 75%, 
                rgba(139, 92, 246, 0.2) 100%);
            border-radius: var(--border-radius-large);
            z-index: -1;
        }

        /* ===== STORY & NARRATIVE STYLES ===== */
        .chapter-header {
            text-align: center;
            margin-bottom: var(--space-xl);
        }

        .chapter-title {
            font-family: var(--font-title);
            font-size: 2.8rem;
            font-weight: 600;
            color: var(--color-primary-glow);
            margin-bottom: var(--space-md);
            text-shadow: 0 0 20px rgba(224, 150, 88, 0.4);
        }

        .chapter-subtitle {
            font-family: var(--font-story);
            font-size: 1.4rem;
            color: var(--color-text-muted);
            font-style: italic;
            margin-bottom: var(--space-lg);
        }

        .sacred-narrative {
            font-family: var(--font-story);
            font-size: 1.3rem;
            line-height: 1.8;
            margin-bottom: var(--space-xl);
            text-align: justify;
        }

        .sacred-narrative p {
            margin-bottom: var(--space-lg);
            text-indent: 2rem;
        }

        .sacred-narrative .philosophical-highlight {
            color: var(--color-primary-glow);
            font-weight: 500;
            position: relative;
        }

        .sacred-narrative .philosophical-highlight::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--color-primary), transparent);
        }

        /* ===== PREMIUM PUZZLE CONTAINER ===== */
        .sacred-trial-chamber {
            background: linear-gradient(135deg, 
                rgba(139, 92, 246, 0.12) 0%, 
                rgba(224, 150, 88, 0.08) 50%,
                rgba(99, 180, 209, 0.12) 100%);
            border: 3px solid rgba(139, 92, 246, 0.4);
            border-radius: var(--border-radius-large);
            padding: var(--space-2xl);
            margin: var(--space-xl) 0;
            position: relative;
            overflow: hidden;
        }

        .sacred-trial-chamber::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                from 0deg,
                transparent,
                rgba(139, 92, 246, 0.08),
                transparent 120deg,
                rgba(224, 150, 88, 0.08) 180deg,
                transparent 240deg,
                rgba(99, 180, 209, 0.08) 300deg,
                transparent
            );
            animation: trial-aura 45s linear infinite;
            z-index: -1;
        }

        @keyframes trial-aura {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .trial-title {
            font-family: var(--font-title);
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: var(--space-md);
            background: linear-gradient(45deg, var(--color-cosmic), var(--color-primary));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .trial-description {
            font-family: var(--font-story);
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: var(--space-xl);
            line-height: 1.7;
            color: var(--color-text);
            padding: 0 var(--space-lg);
        }

        /* ===== PHILOSOPHICAL PROGRESS SYSTEM ===== */
        .dharma-progress {
            display: flex;
            justify-content: center;
            gap: var(--space-lg);
            margin: var(--space-xl) 0;
            flex-wrap: wrap;
        }

        .dharma-stage {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid rgba(224, 150, 88, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
            position: relative;
            transition: all var(--transition-speed) var(--transition-spring);
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .dharma-stage.achieved {
            background: linear-gradient(135deg, var(--color-success), #059669);
            border-color: var(--color-success);
            color: white;
            animation: achievement-pulse 2s ease-in-out infinite;
        }

        .dharma-stage.active {
            background: linear-gradient(135deg, var(--color-cosmic), #7c3aed);
            border-color: var(--color-cosmic);
            color: white;
            animation: active-cosmic-pulse 3s ease-in-out infinite;
            transform: scale(1.1);
        }

        .dharma-stage.locked {
            background: rgba(122, 118, 112, 0.2);
            border-color: var(--color-text-subtle);
            color: var(--color-text-subtle);
        }

        @keyframes achievement-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
            50% { box-shadow: 0 0 35px rgba(16, 185, 129, 0.8); }
        }

        @keyframes active-cosmic-pulse {
            0%, 100% { box-shadow: 0 0 25px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 45px rgba(139, 92, 246, 0.9); }
        }

        .dharma-stage-label {
            font-size: 0.7rem;
            margin-top: var(--space-xs);
            text-align: center;
        }

        /* ===== BANYAN TREE WISDOM TRIAL ===== */
        .wisdom-trial {
            display: none;
            animation: wisdom-reveal 1s ease-out;
        }

        .wisdom-trial.active {
            display: block;
        }

        @keyframes wisdom-reveal {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .trial-stage-title {
            font-family: var(--font-title);
            font-size: 1.8rem;
            color: var(--color-primary);
            margin-bottom: var(--space-md);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .trial-stage-description {
            text-align: center;
            margin-bottom: var(--space-xl);
            font-size: 1.1rem;
            line-height: 1.6;
            padding: 0 var(--space-md);
        }

        /* ===== HARMONIC RESONANCE INTERFACE ===== */
        .harmonic-matrix {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-xl);
            margin: var(--space-xl) 0;
        }

        .resonance-sphere {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(224, 150, 88, 0.4);
            border-radius: var(--border-radius-large);
            padding: var(--space-lg);
            text-align: center;
            position: relative;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all var(--transition-speed) ease;
        }

        .resonance-sphere:hover {
            border-color: var(--color-cosmic);
            transform: translateY(-5px);
            box-shadow: var(--shadow-cosmic);
        }

        .sphere-title {
            font-weight: bold;
            color: var(--color-primary);
            margin-bottom: var(--space-md);
            font-size: 1.2rem;
        }

        .cosmic-wheel {
            width: 140px;
            height: 140px;
            margin: 0 auto var(--space-md);
            border: 3px solid var(--color-primary);
            border-radius: 50%;
            position: relative;
            background: radial-gradient(circle, rgba(224, 150, 88, 0.15) 0%, transparent 70%);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
        }

        .cosmic-wheel:hover {
            border-color: var(--color-cosmic);
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.5);
        }

        .frequency-marker {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--color-cosmic);
            border-radius: 50%;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            transition: transform var(--transition-speed) ease;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.6);
        }

        .frequency-control {
            width: 100%;
            margin: var(--space-md) 0;
        }

        .cosmic-slider {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            background: linear-gradient(to right, 
                rgba(224, 150, 88, 0.3), 
                rgba(139, 92, 246, 0.3));
            border-radius: 4px;
            outline: none;
            transition: all var(--transition-speed) ease;
        }

        .cosmic-slider:hover {
            background: linear-gradient(to right, 
                rgba(224, 150, 88, 0.5), 
                rgba(139, 92, 246, 0.5));
        }

        .cosmic-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--color-cosmic), var(--color-primary));
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
            transition: all var(--transition-speed) ease;
        }

        .cosmic-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
        }

        .frequency-display {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--color-text);
            font-family: var(--font-title);
        }

        /* ===== SACRED GEOMETRY GRID ===== */
        .geometry-mandala {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-sm);
            max-width: 560px;
            margin: var(--space-xl) auto;
            padding: var(--space-xl);
            background: rgba(0, 0, 0, 0.4);
            border-radius: var(--border-radius-large);
            border: 2px solid rgba(139, 92, 246, 0.3);
            backdrop-filter: blur(10px);
        }

        .geometry-node {
            width: 60px;
            height: 60px;
            border: 2px solid rgba(224, 150, 88, 0.4);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-speed) var(--transition-spring);
            background: rgba(26, 24, 23, 0.7);
            font-size: 1.6rem;
            position: relative;
            backdrop-filter: blur(5px);
        }

        .geometry-node::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: var(--border-radius);
            background: linear-gradient(45deg, transparent, rgba(139, 92, 246, 0.3), transparent);
            z-index: -1;
            opacity: 0;
            transition: opacity var(--transition-speed) ease;
        }

        .geometry-node:hover {
            border-color: var(--color-cosmic);
            background: rgba(139, 92, 246, 0.25);
            transform: scale(1.15) rotate(5deg);
        }

        .geometry-node:hover::before {
            opacity: 1;
        }

        .geometry-node.activated {
            background: linear-gradient(135deg, var(--color-cosmic), #7c3aed);
            color: white;
            border-color: var(--color-cosmic);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.7);
            transform: scale(1.1);
        }

        .geometry-node.correct {
            background: linear-gradient(135deg, var(--color-success), #059669);
            border-color: var(--color-success);
            animation: sacred-activation 1.5s ease-out;
        }

        .geometry-node.incorrect {
            background: linear-gradient(135deg, var(--color-danger), #dc2626);
            border-color: var(--color-danger);
            animation: sacred-rejection 0.8s ease-out;
        }

        @keyframes sacred-activation {
            0% { transform: scale(1); }
            50% { transform: scale(1.3) rotate(180deg); box-shadow: 0 0 30px rgba(16, 185, 129, 1); }
            100% { transform: scale(1.1) rotate(360deg); }
        }

        @keyframes sacred-rejection {
            0%, 100% { transform: scale(1) translateX(0); }
            25% { transform: scale(1.1) translateX(-10px); }
            75% { transform: scale(1.1) translateX(10px); }
        }

        /* ===== CHAKRA AWAKENING MANDALA ===== */
        .chakra-cosmos {
            width: 450px;
            height: 450px;
            margin: var(--space-xl) auto;
            position: relative;
            border: 3px solid var(--color-cosmic);
            border-radius: 50%;
            background: radial-gradient(
                circle,
                rgba(139, 92, 246, 0.15) 0%,
                rgba(224, 150, 88, 0.1) 40%,
                rgba(99, 180, 209, 0.15) 70%,
                transparent 100%
            );
            backdrop-filter: blur(10px);
            animation: chakra-cosmos-rotation 60s linear infinite;
        }

        @keyframes chakra-cosmos-rotation {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .chakra-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border: 2px solid var(--color-primary);
            border-radius: 50%;
            background: radial-gradient(circle, rgba(224, 150, 88, 0.3) 0%, transparent 70%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--color-primary);
            animation: center-pulse 4s ease-in-out infinite;
        }

        @keyframes center-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(224, 150, 88, 0.4); }
            50% { box-shadow: 0 0 40px rgba(224, 150, 88, 0.8); }
        }

        .chakra-point {
            position: absolute;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-speed) var(--transition-spring);
            font-size: 2rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
        }

        .chakra-point:hover {
            transform: scale(1.25) rotate(10deg);
            box-shadow: 0 0 30px currentColor;
        }

        .chakra-point.awakened {
            animation: chakra-awakening 3s ease-in-out infinite;
            transform: scale(1.15);
        }

        @keyframes chakra-awakening {
            0%, 100% { 
                box-shadow: 0 0 25px currentColor; 
                filter: brightness(1);
            }
            50% { 
                box-shadow: 0 0 50px currentColor; 
                filter: brightness(1.5);
            }
        }

        /* ===== SEQUENCE DISPLAY ===== */
        .awakening-sequence {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin: var(--space-xl) 0;
            flex-wrap: wrap;
        }

        .sequence-node {
            width: 60px;
            height: 60px;
            border: 2px solid rgba(224, 150, 88, 0.4);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.4);
            transition: all var(--transition-speed) ease;
            backdrop-filter: blur(5px);
        }

        .sequence-node.completed {
            background: linear-gradient(135deg, var(--color-success), #059669);
            border-color: var(--color-success);
            color: white;
            animation: sequence-complete 1s ease-out;
        }

        .sequence-node.active {
            background: linear-gradient(135deg, var(--color-cosmic), #7c3aed);
            border-color: var(--color-cosmic);
            color: white;
            animation: sequence-active 2s ease-in-out infinite;
        }

        @keyframes sequence-complete {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); box-shadow: 0 0 25px rgba(16, 185, 129, 0.8); }
            100% { transform: scale(1); }
        }

        @keyframes sequence-active {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(139, 92, 246, 0.8); }
        }

        /* ===== PREMIUM CONTROLS ===== */
        .divine-controls {
            display: flex;
            justify-content: center;
            gap: var(--space-lg);
            margin: var(--space-2xl) 0;
            flex-wrap: wrap;
        }

        .cosmic-button {
            padding: var(--space-md) var(--space-xl);
            border: none;
            border-radius: 30px;
            font-family: var(--font-title);
            font-weight: 600;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            cursor: pointer;
            transition: all var(--transition-speed) var(--transition-spring);
            box-shadow: var(--shadow-soft);
            min-width: 140px;
            position: relative;
            overflow: hidden;
        }

        .cosmic-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .cosmic-button:hover::before {
            left: 100%;
        }

        .cosmic-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .cosmic-button:active {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-cosmic), #7c3aed);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #7c3aed, var(--color-cosmic));
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-glow));
            color: var(--color-bg);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--color-primary-glow), var(--color-primary));
            box-shadow: 0 8px 25px rgba(224, 150, 88, 0.4);
        }

        .btn-wisdom {
            background: linear-gradient(135deg, var(--color-info), #1d4ed8);
            color: white;
        }

        .btn-wisdom:hover {
            background: linear-gradient(135deg, #1d4ed8, var(--color-info));
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--color-danger), #dc2626);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, var(--color-danger));
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        /* ===== SPIRITUAL FEEDBACK SYSTEM ===== */
        .cosmic-feedback {
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: var(--space-xl) 0;
        }

        .divine-message {
            padding: var(--space-lg) var(--space-xl);
            border-radius: var(--border-radius-large);
            font-weight: 500;
            text-align: center;
            max-width: 700px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s var(--transition-spring);
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
        }

        .divine-message.manifest {
            opacity: 1;
            transform: translateY(0);
        }

        .message-success {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--color-success);
            color: var(--color-success);
            box-shadow: 0 0 25px rgba(16, 185, 129, 0.3);
        }

        .message-error {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--color-danger);
            color: var(--color-danger);
            box-shadow: 0 0 25px rgba(239, 68, 68, 0.3);
        }

        .message-wisdom {
            background: rgba(139, 92, 246, 0.2);
            border-color: var(--color-cosmic);
            color: var(--color-cosmic);
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.3);
        }

        .message-warning {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--color-warning);
            color: var(--color-warning);
            box-shadow: 0 0 25px rgba(245, 158, 11, 0.3);
        }

        /* ===== SIDEBAR PANELS ===== */
        .enlightenment-sidebar {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        .wisdom-panel {
            background: rgba(26, 24, 23, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(224, 150, 88, 0.25);
            border-radius: var(--border-radius-large);
            padding: var(--space-lg);
            box-shadow: var(--shadow-medium);
            position: relative;
        }

        .wisdom-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(to right, 
                var(--color-primary), 
                var(--color-cosmic), 
                var(--color-primary));
            border-radius: var(--border-radius-large) var(--border-radius-large) 0 0;
        }

        .panel-title {
            font-family: var(--font-title);
            color: var(--color-primary);
            font-size: 1.4rem;
            margin-bottom: var(--space-md);
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 1px solid rgba(224, 150, 88, 0.2);
            padding-bottom: var(--space-sm);
        }

        /* ===== CHARACTER DISPLAY ===== */
        .soul-avatar {
            text-align: center;
            margin-bottom: var(--space-lg);
        }

        .avatar-mandala {
            width: 140px;
            height: 140px;
            margin: 0 auto var(--space-md);
            border: 3px solid var(--color-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle, rgba(224, 150, 88, 0.15) 0%, transparent 70%);
            animation: avatar-sacred-pulse 5s ease-in-out infinite;
            position: relative;
        }

        .avatar-mandala::before {
            content: '';
            position: absolute;
            width: 110%;
            height: 110%;
            border: 1px solid rgba(224, 150, 88, 0.3);
            border-radius: 50%;
            animation: avatar-rings 8s linear infinite;
        }

        @keyframes avatar-sacred-pulse {
            0%, 100% { box-shadow: 0 0 25px rgba(224, 150, 88, 0.4); }
            50% { box-shadow: 0 0 40px rgba(224, 150, 88, 0.7); }
        }

        @keyframes avatar-rings {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .soul-name {
            font-family: var(--font-title);
            font-size: 2rem;
            color: var(--color-primary-glow);
            margin-bottom: var(--space-xs);
            font-weight: 600;
        }

        .soul-path {
            color: var(--color-text-muted);
            font-style: italic;
            margin-bottom: var(--space-md);
            font-size: 1.1rem;
        }

        /* ===== SPIRITUAL PROGRESS STATS ===== */
        .dharma-metrics {
            display: grid;
            gap: var(--space-md);
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) var(--space-md);
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-primary);
            transition: all var(--transition-speed) ease;
        }

        .metric-item:hover {
            background: rgba(224, 150, 88, 0.1);
            transform: translateX(5px);
        }

        .metric-label {
            font-weight: 600;
            color: var(--color-text);
        }

        .metric-value {
            color: var(--color-primary);
            font-weight: bold;
            font-size: 1.2rem;
            font-family: var(--font-title);
        }

        /* ===== SACRED ARTIFACTS ===== */
        .artifact-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background: rgba(139, 92, 246, 0.1);
            border-radius: var(--border-radius);
            border: 1px solid rgba(139, 92, 246, 0.3);
            margin-bottom: var(--space-sm);
            transition: all var(--transition-speed) ease;
        }

        .artifact-item:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: scale(1.02);
        }

        .artifact-icon {
            font-size: 1.5rem;
            color: var(--color-cosmic);
        }

        .artifact-name {
            color: var(--color-text);
            font-weight: 500;
        }

        .artifact-empty {
            text-align: center;
            color: var(--color-text-muted);
            font-style: italic;
            padding: var(--space-md);
        }

        /* ===== NOTIFICATION SYSTEM ===== */
        .cosmic-notifications {
            position: fixed;
            top: 120px;
            right: var(--space-lg);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .divine-notification {
            background: rgba(26, 24, 23, 0.95);
            backdrop-filter: blur(25px);
            border: 2px solid var(--color-primary);
            border-radius: var(--border-radius-large);
            padding: var(--space-md) var(--space-lg);
            box-shadow: var(--shadow-strong);
            transform: translateX(120%);
            opacity: 0;
            transition: all 0.6s var(--transition-spring);
            min-width: 350px;
            max-width: 400px;
        }

        .divine-notification.manifest {
            transform: translateX(0);
            opacity: 1;
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .notification-icon {
            font-size: 1.8rem;
            color: var(--color-primary);
        }

        .notification-text {
            flex: 1;
            line-height: 1.5;
        }

        .divine-notification.success {
            border-color: var(--color-success);
        }

        .divine-notification.success .notification-icon {
            color: var(--color-success);
        }

        .divine-notification.error {
            border-color: var(--color-danger);
        }

        .divine-notification.error .notification-icon {
            color: var(--color-danger);
        }

        .divine-notification.wisdom {
            border-color: var(--color-cosmic);
        }

        .divine-notification.wisdom .notification-icon {
            color: var(--color-cosmic);
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1400px) {
            .enlightenment-container {
                grid-template-columns: 1fr;
                gap: var(--space-lg);
            }

            .harmonic-matrix {
                grid-template-columns: 1fr;
                gap: var(--space-lg);
            }

            .geometry-mandala {
                grid-template-columns: repeat(5, 1fr);
                max-width: 400px;
            }

            .chakra-cosmos {
                width: 350px;
                height: 350px;
            }
        }

        @media (max-width: 768px) {
            .enlightenment-container {
                padding: var(--space-md);
            }

            .journey-canvas {
                padding: var(--space-lg);
            }

            .game-title {
                font-size: 2rem;
            }

            .sacred-header {
                padding: var(--space-md);
            }

            .geometry-mandala {
                grid-template-columns: repeat(4, 1fr);
                max-width: 300px;
            }

            .geometry-node {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }

            .chakra-cosmos {
                width: 280px;
                height: 280px;
            }

            .chakra-point {
                width: 55px;
                height: 55px;
                font-size: 1.5rem;
            }

            .divine-controls {
                flex-direction: column;
                align-items: center;
            }

            .cosmic-button {
                min-width: 200px;
            }

            .cosmic-notifications {
                right: var(--space-sm);
                left: var(--space-sm);
            }

            .divine-notification {
                min-width: auto;
            }
        }

        /* ===== CUSTOM SCROLLBAR ===== */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(224, 150, 88, 0.1);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--color-primary), var(--color-cosmic));
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--color-primary-glow), #a855f7);
        }

        /* ===== ACCESSIBILITY ENHANCEMENTS ===== */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (prefers-color-scheme: light) {
            :root {
                --color-bg: #f7f6f3;
                --color-surface: #ffffff;
                --color-text: #2d2d2d;
                --color-text-muted: #6b6b6b;
            }
        }

        /* ===== LOADING ANIMATIONS ===== */
        .divine-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .mandala-spinner {
            width: 80px;
            height: 80px;
            border: 3px solid rgba(224, 150, 88, 0.3);
            border-top: 3px solid var(--color-primary);
            border-radius: 50%;
            animation: divine-spin 2s linear infinite;
        }

        @keyframes divine-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== FOCUS STATES FOR ACCESSIBILITY ===== */
        button:focus,
        input:focus,
        .geometry-node:focus,
        .chakra-point:focus {
            outline: 3px solid var(--color-primary);
            outline-offset: 2px;
        }

        /* ===== PRINT STYLES ===== */
        @media print {
            .cosmic-environment,
            .cosmic-notifications,
            .divine-controls {
                display: none;
            }
            
            body {
                background: white;
                color: black;
            }
        }

        /* ===== HIGH CONTRAST MODE ===== */
        @media (prefers-contrast: high) {
            :root {
                --color-primary: #ffaa00;
                --color-cosmic: #9900ff;
                --color-text: #ffffff;
            }
        }
    </style>
</head>
<body>
    <!-- Immersive Cosmic Environment -->
    <div class="cosmic-environment">
        <div class="stellar-field"></div>
        <div class="cosmic-mandala"></div>
        <div class="energy-particles"></div>
    </div>

    <!-- Sacred Header -->
    <header class="sacred-header">
        <div class="title-mandala">
            <div class="sacred-symbol">🕉️</div>
            <h1 class="game-title">Samsara Saga</h1>
        </div>
        <div class="journey-badge">
            <i class="fas fa-star"></i>
            The Eternal Journey
        </div>
    </header>

    <!-- Main Enlightenment Container -->
    <div class="enlightenment-container">
        <!-- Journey Canvas (Main Content) -->
        <main class="journey-canvas">
            <!-- Chapter Header -->
            <div class="chapter-header">
                <h2 class="chapter-title">🌳 The Great Banyan's Awakening</h2>
                <p class="chapter-subtitle">Three Sacred Trials of Cosmic Harmony</p>
            </div>

            <!-- Sacred Narrative -->
            <div class="sacred-narrative">
                <p>In the ancient village of Dharmapura stands the Great Banyan, a living bridge between earth and sky, matter and spirit. For countless ages, it has watched over the spiritual evolution of seekers, offering its wisdom to those who prove worthy.</p>
                
                <p>You stand before this <span class="philosophical-highlight">sacred guardian</span>, feeling the weight of cosmic consciousness pressing upon your soul. The tree's vast canopy whispers of <span class="philosophical-highlight">dharma</span> and <span class="philosophical-highlight">moksha</span>, while its roots dig deep into the eternal principles of existence.</p>
                
                <p>Three trials await—each a reflection of the fundamental forces that govern all creation. Only by mastering the <span class="philosophical-highlight">harmonic resonance</span> of cosmic frequencies, decoding the <span class="philosophical-highlight">sacred geometry</span> of existence, and awakening the <span class="philosophical-highlight">chakra consciousness</span> within, can you hope to receive the Banyan's ultimate blessing.</p>
            </div>

            <!-- Sacred Trial Chamber -->
            <div class="sacred-trial-chamber">
                <h3 class="trial-title">
                    <i class="fas fa-yin-yang"></i>
                    The Trinity of Cosmic Mastery
                    <i class="fas fa-yin-yang"></i>
                </h3>
                <p class="trial-description">
                    Three sacred dimensions of existence await your understanding. Each trial builds upon the last, testing your grasp of the fundamental forces that weave the fabric of reality itself.
                </p>

                <!-- Dharma Progress -->
                <div class="dharma-progress">
                    <div class="dharma-stage active" data-stage="1">
                        <div>🎵</div>
                        <div class="dharma-stage-label">Harmonic<br>Resonance</div>
                    </div>
                    <div class="dharma-stage locked" data-stage="2">
                        <div>⬢</div>
                        <div class="dharma-stage-label">Sacred<br>Geometry</div>
                    </div>
                    <div class="dharma-stage locked" data-stage="3">
                        <div>👑</div>
                        <div class="dharma-stage-label">Chakra<br>Awakening</div>
                    </div>
                </div>

                <!-- Trial 1: Harmonic Resonance -->
                <div class="wisdom-trial active" id="trial-1">
                    <h4 class="trial-stage-title">
                        <i class="fas fa-wave-square"></i>
                        Stage 1: Harmonic Resonance Mastery
                    </h4>
                    <p class="trial-stage-description">
                        The universe vibrates with sacred frequencies. Align the three fundamental tones—Sattva, Rajas, and Tamas—to achieve cosmic resonance. Each sphere represents a guna, and together they must form the perfect triad of 108°, 144°, and 180°.
                    </p>

                    <div class="harmonic-matrix">
                        <div class="resonance-sphere">
                            <div class="sphere-title">Sattva Harmony</div>
                            <div class="cosmic-wheel" id="wheel-1">
                                <div class="frequency-marker" id="marker-1"></div>
                            </div>
                            <div class="frequency-control">
                                <input type="range" min="0" max="360" value="0" class="cosmic-slider" id="freq-1">
                            </div>
                            <div class="frequency-display" id="display-1">432 Hz</div>
                        </div>

                        <div class="resonance-sphere">
                            <div class="sphere-title">Rajas Dynamism</div>
                            <div class="cosmic-wheel" id="wheel-2">
                                <div class="frequency-marker" id="marker-2"></div>
                            </div>
                            <div class="frequency-control">
                                <input type="range" min="0" max="360" value="120" class="cosmic-slider" id="freq-2">
                            </div>
                            <div class="frequency-display" id="display-2">528 Hz</div>
                        </div>

                        <div class="resonance-sphere">
                            <div class="sphere-title">Tamas Stillness</div>
                            <div class="cosmic-wheel" id="wheel-3">
                                <div class="frequency-marker" id="marker-3"></div>
                            </div>
                            <div class="frequency-control">
                                <input type="range" min="0" max="360" value="240" class="cosmic-slider" id="freq-3">
                            </div>
                            <div class="frequency-display" id="display-3">639 Hz</div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: var(--space-lg) 0;">
                        <div style="font-weight: bold; color: var(--color-cosmic); margin-bottom: var(--space-xs);">
                            Target Sacred Ratio: 3:4:5 (The Divine Proportion)
                        </div>
                        <div style="color: var(--color-text-muted); font-size: 0.9rem;">
                            "As above, so below" - Align the frequencies to mirror cosmic harmony
                        </div>
                    </div>
                </div>

                <!-- Trial 2: Sacred Geometry -->
                <div class="wisdom-trial" id="trial-2">
                    <h4 class="trial-stage-title">
                        <i class="fas fa-gem"></i>
                        Stage 2: Sacred Geometry Activation
                    </h4>
                    <p class="trial-stage-description">
                        Activate the nodes to manifest the Flower of Life pattern. This sacred geometry underlies all creation, from the smallest atom to the grandest galaxy. Begin with the center and allow the pattern to unfold naturally.
                    </p>

                    <div class="geometry-mandala" id="geometry-mandala">
                        <!-- Nodes will be generated by JavaScript -->
                    </div>

                    <div style="text-align: center; margin: var(--space-lg) 0;">
                        <div style="font-weight: bold; color: var(--color-cosmic); margin-bottom: var(--space-xs);">
                            The Flower of Life Manifestation
                        </div>
                        <div style="color: var(--color-text-muted); font-size: 0.9rem;">
                            "In the beginning was the Word, and the Word was sacred geometry"
                        </div>
                    </div>
                </div>

                <!-- Trial 3: Chakra Awakening -->
                <div class="wisdom-trial" id="trial-3">
                    <h4 class="trial-stage-title">
                        <i class="fas fa-crown"></i>
                        Stage 3: Chakra Awakening Mastery
                    </h4>
                    <p class="trial-stage-description">
                        Awaken the seven energy centers in their sacred sequence. Each chakra must be activated at the precise cosmic moment. Feel the rhythm of the universe and synchronize your consciousness with the eternal dance of creation.
                    </p>

                    <div class="chakra-cosmos" id="chakra-cosmos">
                        <div class="chakra-center">🕉️</div>
                        <!-- Chakra points will be positioned by JavaScript -->
                    </div>

                    <div class="awakening-sequence" id="chakra-sequence">
                        <!-- Sequence nodes will be generated by JavaScript -->
                    </div>

                    <div style="text-align: center; margin: var(--space-lg) 0;">
                        <div style="font-weight: bold; color: var(--color-cosmic); margin-bottom: var(--space-xs);">
                            Cosmic Timing Synchronization: 3-Second Pulses
                        </div>
                        <div style="color: var(--color-text-muted); font-size: 0.9rem;">
                            "When you align with cosmic rhythm, you become one with the eternal dance"
                        </div>
                    </div>
                </div>

                <!-- Cosmic Feedback -->
                <div class="cosmic-feedback">
                    <div class="divine-message" id="divine-message"></div>
                </div>

                <!-- Divine Controls -->
                <div class="divine-controls">
                    <button class="cosmic-button btn-primary" onclick="validateCurrentTrial()">
                        <i class="fas fa-check-circle"></i>
                        Validate Trial
                    </button>
                    <button class="cosmic-button btn-wisdom" onclick="receiveCosmicWisdom()">
                        <i class="fas fa-star"></i>
                        Cosmic Guidance
                    </button>
                    <button class="cosmic-button btn-danger" onclick="resetCurrentTrial()">
                        <i class="fas fa-redo"></i>
                        Reset Trial
                    </button>
                    <button class="cosmic-button btn-secondary" onclick="transcendToNextRealm()">
                        <i class="fas fa-forward"></i>
                        Continue Journey
                    </button>
                </div>
            </div>
        </main>

        <!-- Enlightenment Sidebar -->
        <aside class="enlightenment-sidebar">
            <!-- Character Panel -->
            <div class="wisdom-panel">
                <h3 class="panel-title">Soul Essence</h3>
                <div class="soul-avatar">
                    <div class="avatar-mandala">
                        <svg viewBox="0 0 100 100" width="100" height="100">
                            <rect x="30" y="30" width="40" height="40" stroke="#e09658" stroke-width="3" fill="none"/>
                            <circle cx="50" cy="50" r="35" stroke="#e09658" stroke-width="2" fill="none" opacity="0.6"/>
                        </svg>
                    </div>
                    <div class="soul-name" id="soul-name">Uttara Phalguni</div>
                    <div class="soul-path" id="soul-path">Manushya Gana - The Human Path</div>
                </div>
            </div>

            <!-- Spiritual Progress -->
            <div class="wisdom-panel">
                <h3 class="panel-title">Spiritual Progress</h3>
                <div class="dharma-metrics">
                    <div class="metric-item">
                        <span class="metric-label">Karma</span>
                        <span class="metric-value" id="karma-metric">0</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Wisdom</span>
                        <span class="metric-value" id="wisdom-metric">0</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Trials Mastered</span>
                        <span class="metric-value" id="trials-metric">0/3</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Consciousness Level</span>
                        <span class="metric-value" id="consciousness-metric">Seeker</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Cosmic Attunement</span>
                        <span class="metric-value" id="attunement-metric">12%</span>
                    </div>
                </div>
            </div>

            <!-- Sacred Artifacts -->
            <div class="wisdom-panel">
                <h3 class="panel-title">Sacred Artifacts</h3>
                <div id="artifacts-collection" class="artifact-empty">
                    The artifacts of wisdom await your mastery of the trials...
                </div>
            </div>

            <!-- Divine Actions -->
            <div class="wisdom-panel">
                <h3 class="panel-title">Divine Actions</h3>
                <div style="display: flex; flex-direction: column; gap: var(--space-md);">
                    <button class="cosmic-button btn-secondary" onclick="preserveJourney()" style="width: 100%;">
                        <i class="fas fa-save"></i>
                        Preserve Journey
                    </button>
                    <button class="cosmic-button btn-wisdom" onclick="enterDeepMeditation()" style="width: 100%;">
                        <i class="fas fa-meditation"></i>
                        Deep Meditation
                    </button>
                    <button class="cosmic-button btn-primary" onclick="contemplateWisdom()" style="width: 100%;">
                        <i class="fas fa-book-open"></i>
                        Contemplate Wisdom
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Cosmic Notifications -->
    <div class="cosmic-notifications" id="cosmic-notifications"></div>

    <!-- JavaScript: Premium Philosophical Adventure Engine -->
    <script>
        // ===== COMPREHENSIVE GAME STATE MANAGEMENT =====
        class SamsaraSagaEngine {
            constructor() {
                this.currentTrial = 1;
                this.completedTrials = [];
                this.startTime = Date.now();
                this.hintsUsed = 0;
                
                // Spiritual Progress
                this.spiritualState = {
                    karma: 0,
                    wisdom: 0,
                    consciousness: 'Seeker',
                    attunement: 12,
                    trialsCompleted: 0
                };
                
                // Trial 1: Harmonic Resonance
                this.harmonics = {
                    freq1: 0,    // Target: 108 (sacred number)
                    freq2: 120,  // Target: 144 (108 * 4/3)
                    freq3: 240   // Target: 180 (108 * 5/3)
                };
                
                // Trial 2: Sacred Geometry
                this.geometryPattern = [];
                this.flowerOfLifeSequence = [24, 25, 26, 17, 18, 19, 10, 11, 12, 31, 32, 33, 38, 39, 40, 45, 46, 47];
                
                // Trial 3: Chakra System
                this.chakraSequence = [];
                this.chakraOrder = ['root', 'sacral', 'solar', 'heart', 'throat', 'third-eye', 'crown'];
                this.cosmicTimer = null;
                this.lastChakraActivation = 0;
                
                this.artifacts = [];
                this.initializeExperience();
            }
            
            initializeExperience() {
                this.setupCharacterFromURL();
                this.initializeTrial1();
                this.initializeTrial2();
                this.initializeTrial3();
                this.updateAllDisplays();
                this.startCosmicBackgroundMusic();
                this.showWelcomeMessage();
            }
            
            setupCharacterFromURL() {
                const urlParams = new URLSearchParams(window.location.search);
                const nakshatraNum = urlParams.get('nakshatra');
                
                const nakshatraWisdom = {
                    12: { 
                        name: 'Uttara Phalguni', 
                        path: 'Manushya Gana - The Human Path',
                        element: 'fire',
                        wisdom: 'To accumulate security through righteous action'
                    },
                    1: { 
                        name: 'Ashwini', 
                        path: 'Deva Gana - The Divine Path',
                        element: 'fire',
                        wisdom: 'To heal quickly and restore cosmic balance'
                    }
                };
                
                if (nakshatraNum && nakshatraWisdom[nakshatraNum]) {
                    const nakshatra = nakshatraWisdom[nakshatraNum];
                    document.getElementById('soul-name').textContent = nakshatra.name;
                    document.getElementById('soul-path').textContent = nakshatra.path;
                    
                    // Show personalized welcome
                    setTimeout(() => {
                        this.showDivineMessage(
                            `Welcome, soul of ${nakshatra.name}. Your path of ${nakshatra.wisdom.toLowerCase()} begins now.`,
                            'wisdom'
                        );
                    }, 2000);
                }
            }
            
            // ===== TRIAL 1: HARMONIC RESONANCE =====
            initializeTrial1() {
                for (let i = 1; i <= 3; i++) {
                    const slider = document.getElementById(`freq-${i}`);
                    const wheel = document.getElementById(`wheel-${i}`);
                    const marker = document.getElementById(`marker-${i}`);
                    
                    if (slider && wheel && marker) {
                        slider.addEventListener('input', () => this.updateFrequency(i));
                        wheel.addEventListener('click', () => this.adjustFrequency(i));
                        this.updateFrequency(i);
                    }
                }
            }
            
            adjustFrequency(chamber) {
                const slider = document.getElementById(`freq-${chamber}`);
                if (!slider) return;
                
                const currentValue = parseInt(slider.value);
                const newValue = (currentValue + 36) % 360; // 10-degree increments
                slider.value = newValue;
                this.updateFrequency(chamber);
            }
            
            updateFrequency(chamber) {
                const slider = document.getElementById(`freq-${chamber}`);
                const marker = document.getElementById(`marker-${chamber}`);
                const display = document.getElementById(`display-${chamber}`);
                
                if (!slider || !marker || !display) return;
                
                const angle = slider.value;
                this.harmonics[`freq${chamber}`] = parseInt(angle);
                
                // Update visual marker with smooth animation
                marker.style.transform = `translateX(-50%) rotate(${angle}deg) translateY(-65px)`;
                
                // Calculate sacred frequency based on angle
                const baseFreq = [432, 528, 639][chamber - 1];
                const frequency = Math.round(baseFreq + (angle / 360) * 200);
                display.textContent = `${frequency} Hz`;
                
                // Add visual feedback
                const wheel = document.getElementById(`wheel-${chamber}`);
                wheel.style.borderColor = this.getHarmonicColor(angle);
                
                // Check for cosmic resonance
                this.checkHarmonicResonance();
            }
            
            getHarmonicColor(angle) {
                const targetAngles = [108, 144, 180];
                const closestTarget = targetAngles.reduce((prev, curr) => 
                    Math.abs(curr - angle) < Math.abs(prev - angle) ? curr : prev
                );
                const distance = Math.abs(closestTarget - angle);
                
                if (distance <= 8) return '#8b5cf6'; // Perfect alignment - cosmic purple
                if (distance <= 15) return '#e09658'; // Close - primary orange
                return 'rgba(224, 150, 88, 0.4)'; // Default
            }
            
            checkHarmonicResonance() {
                if (this.currentTrial !== 1) return;
                
                const target1 = 108, target2 = 144, target3 = 180;
                const tolerance = 8;
                
                const freq1 = this.harmonics.freq1;
                const freq2 = this.harmonics.freq2;
                const freq3 = this.harmonics.freq3;
                
                const aligned = Math.abs(freq1 - target1) <= tolerance &&
                               Math.abs(freq2 - target2) <= tolerance &&
                               Math.abs(freq3 - target3) <= tolerance;
                
                if (aligned) {
                    this.completeTrial(1);
                }
            }
            
            // ===== TRIAL 2: SACRED GEOMETRY =====
            initializeTrial2() {
                const mandala = document.getElementById('geometry-mandala');
                if (!mandala) return;
                
                mandala.innerHTML = '';
                
                // Create 7x7 sacred grid (49 nodes)
                for (let i = 0; i < 49; i++) {
                    const node = document.createElement('div');
                    node.className = 'geometry-node';
                    node.dataset.index = i;
                    node.addEventListener('click', () => this.activateGeometryNode(i));
                    
                    // Add sacred symbols to flower of life positions
                    const sacredSymbols = ['⬢', '◈', '◉', '⬟', '◎', '◈', '⬢', '❋', '✦', '✧'];
                    if (this.flowerOfLifeSequence.includes(i)) {
                        node.textContent = sacredSymbols[Math.floor(Math.random() * sacredSymbols.length)];
                    }
                    
                    // Add tooltip with position information
                    node.title = `Sacred Node ${i + 1}`;
                    
                    mandala.appendChild(node);
                }
            }
            
            activateGeometryNode(index) {
                if (this.currentTrial !== 2) return;
                
                const node = document.querySelector(`[data-index="${index}"]`);
                if (!node) return;
                
                if (this.geometryPattern.includes(index)) {
                    // Deactivate node
                    this.geometryPattern = this.geometryPattern.filter(i => i !== index);
                    node.classList.remove('activated');
                } else {
                    // Activate node
                    this.geometryPattern.push(index);
                    node.classList.add('activated');
                    
                    // Check if sequence is correct so far
                    const isCorrectSequence = this.geometryPattern.every((nodeIndex, i) => 
                        nodeIndex === this.flowerOfLifeSequence[i]
                    );
                    
                    if (!isCorrectSequence) {
                        // Incorrect pattern - reset with beautiful animation
                        node.classList.add('incorrect');
                        setTimeout(() => {
                            this.resetGeometryPattern();
                            this.showDivineMessage(
                                'The sacred geometry resists disorder. The pattern must unfold in its natural sequence.',
                                'error'
                            );
                        }, 1500);
                        return;
                    }
                    
                    node.classList.add('correct');
                    
                    // Play success sound effect (visual feedback)
                    this.createActivationEffect(node);
                    
                    // Check if complete
                    if (this.geometryPattern.length === this.flowerOfLifeSequence.length) {
                        this.completeTrial(2);
                    } else {
                        // Encouraging feedback for partial completion
                        const progress = this.geometryPattern.length;
                        const total = this.flowerOfLifeSequence.length;
                        this.showDivineMessage(
                            `Sacred geometry unfolds... ${progress}/${total} nodes aligned.`,
                            'wisdom'
                        );
                    }
                }
            }
            
            createActivationEffect(node) {
                // Create ripple effect
                const ripple = document.createElement('div');
                ripple.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    width: 0;
                    height: 0;
                    border-radius: 50%;
                    background: radial-gradient(circle, rgba(139, 92, 246, 0.6) 0%, transparent 70%);
                    transform: translate(-50%, -50%);
                    pointer-events: none;
                    z-index: 10;
                `;
                
                node.style.position = 'relative';
                node.appendChild(ripple);
                
                // Animate ripple
                ripple.animate([
                    { width: '0px', height: '0px', opacity: 1 },
                    { width: '100px', height: '100px', opacity: 0 }
                ], {
                    duration: 800,
                    easing: 'ease-out'
                }).onfinish = () => ripple.remove();
            }
            
            resetGeometryPattern() {
                this.geometryPattern = [];
                document.querySelectorAll('.geometry-node').forEach(node => {
                    node.classList.remove('activated', 'correct', 'incorrect');
                });
            }
            
            // ===== TRIAL 3: CHAKRA AWAKENING =====
            initializeTrial3() {
                const cosmos = document.getElementById('chakra-cosmos');
                if (!cosmos) return;
                
                // Clear existing chakras (keep center)
                const existingChakras = cosmos.querySelectorAll('.chakra-point');
                existingChakras.forEach(chakra => chakra.remove());
                
                const chakras = [
                    { name: 'root', color: '#e74c3c', symbol: '🔴', angle: 270, label: 'Muladhara' },
                    { name: 'sacral', color: '#e67e22', symbol: '🟠', angle: 315, label: 'Svadhisthana' },
                    { name: 'solar', color: '#f1c40f', symbol: '🟡', angle: 0, label: 'Manipura' },
                    { name: 'heart', color: '#27ae60', symbol: '💚', angle: 45, label: 'Anahata' },
                    { name: 'throat', color: '#3498db', symbol: '🔵', angle: 90, label: 'Vishuddha' },
                    { name: 'third-eye', color: '#8e44ad', symbol: '🟣', angle: 135, label: 'Ajna' },
                    { name: 'crown', color: '#9b59b6', symbol: '👑', angle: 180, label: 'Sahasrara' }
                ];
                
                chakras.forEach((chakra, index) => {
                    const chakraElement = document.createElement('div');
                    chakraElement.className = 'chakra-point';
                    chakraElement.dataset.chakra = chakra.name;
                    chakraElement.dataset.index = index;
                    chakraElement.style.borderColor = chakra.color;
                    chakraElement.textContent = chakra.symbol;
                    chakraElement.title = `${chakra.label} - ${chakra.name.charAt(0).toUpperCase() + chakra.name.slice(1)} Chakra`;
                    
                    // Position on cosmic circle
                    const radian = (chakra.angle * Math.PI) / 180;
                    const radius = 170;
                    const x = 225 + radius * Math.cos(radian) - 35;
                    const y = 225 + radius * Math.sin(radian) - 35;
                    
                    chakraElement.style.left = x + 'px';
                    chakraElement.style.top = y + 'px';
                    
                    chakraElement.addEventListener('click', () => this.activateChakra(chakra.name, index));
                    cosmos.appendChild(chakraElement);
                });
                
                this.setupChakraSequenceDisplay();
                this.startCosmicPulse();
            }
            
            setupChakraSequenceDisplay() {
                const sequenceContainer = document.getElementById('chakra-sequence');
                if (!sequenceContainer) return;
                
                sequenceContainer.innerHTML = '';
                
                this.chakraOrder.forEach((chakra, index) => {
                    const step = document.createElement('div');
                    step.className = 'sequence-node';
                    step.dataset.chakra = chakra;
                    step.textContent = index + 1;
                    step.title = `${chakra.charAt(0).toUpperCase() + chakra.slice(1)} Chakra`;
                    sequenceContainer.appendChild(step);
                });
                
                // Highlight first step
                if (sequenceContainer.children[0]) {
                    sequenceContainer.children[0].classList.add('active');
                }
            }
            
            startCosmicPulse() {
                this.cosmicTimer = setInterval(() => {
                    // Cosmic pulse every 3 seconds
                    document.querySelectorAll('.chakra-point').forEach(chakra => {
                        chakra.style.boxShadow = '0 0 40px currentColor';
                        setTimeout(() => {
                            chakra.style.boxShadow = '';
                        }, 800);
                    });
                }, 3000);
            }
            
            activateChakra(chakraName, index) {
                if (this.currentTrial !== 3) return;
                
                const now = Date.now();
                const timeSinceLastActivation = now - this.lastChakraActivation;
                
                // Check cosmic timing (must be within pulse window)
                if (this.chakraSequence.length > 0 && timeSinceLastActivation < 2500) {
                    this.showDivineMessage(
                        'Wait for the cosmic pulse... The chakras must be awakened in harmony with universal rhythm.',
                        'warning'
                    );
                    return;
                }
                
                const expectedChakra = this.chakraOrder[this.chakraSequence.length];
                
                if (chakraName === expectedChakra) {
                    // Correct chakra and timing
                    this.chakraSequence.push(chakraName);
                    this.lastChakraActivation = now;
                    
                    const chakraElement = document.querySelector(`[data-chakra="${chakraName}"]`);
                    chakraElement.classList.add('awakened');
                    
                    // Create awakening effect
                    this.createChakraAwakeningEffect(chakraElement);
                    
                    // Update sequence display
                    this.updateSequenceDisplay();
                    
                    const chakraNames = {
                        'root': 'Muladhara',
                        'sacral': 'Svadhisthana',
                        'solar': 'Manipura',
                        'heart': 'Anahata',
                        'throat': 'Vishuddha',
                        'third-eye': 'Ajna',
                        'crown': 'Sahasrara'
                    };
                    
                    this.showDivineMessage(
                        `${chakraNames[chakraName]} awakened! Energy rises through the cosmic spine...`,
                        'success'
                    );
                    
                    if (this.chakraSequence.length === this.chakraOrder.length) {
                        this.completeTrial(3);
                    }
                } else {
                    // Wrong chakra - reset entire sequence
                    this.showDivineMessage(
                        'The chakras must be awakened in their sacred order. The sequence resets to maintain cosmic harmony.',
                        'error'
                    );
                    this.resetChakraSequence();
                }
            }
            
            createChakraAwakeningEffect(chakraElement) {
                // Create multiple expanding rings
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const ring = document.createElement('div');
                        ring.style.cssText = `
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            width: 0;
                            height: 0;
                            border: 2px solid ${chakraElement.style.borderColor};
                            border-radius: 50%;
                            transform: translate(-50%, -50%);
                            pointer-events: none;
                            z-index: 5;
                        `;
                        
                        chakraElement.style.position = 'relative';
                        chakraElement.appendChild(ring);
                        
                        ring.animate([
                            { width: '0px', height: '0px', opacity: 0.8 },
                            { width: '150px', height: '150px', opacity: 0 }
                        ], {
                            duration: 2000,
                            easing: 'ease-out'
                        }).onfinish = () => ring.remove();
                    }, i * 200);
                }
            }
            
            updateSequenceDisplay() {
                const sequenceSteps = document.querySelectorAll('.sequence-node');
                sequenceSteps.forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    if (index < this.chakraSequence.length) {
                        step.classList.add('completed');
                    } else if (index === this.chakraSequence.length) {
                        step.classList.add('active');
                    }
                });
            }
            
            resetChakraSequence() {
                this.chakraSequence = [];
                document.querySelectorAll('.chakra-point').forEach(chakra => {
                    chakra.classList.remove('awakened');
                });
                this.updateSequenceDisplay();
            }
            
            // ===== TRIAL COMPLETION SYSTEM =====
            completeTrial(trialNum) {
                if (this.completedTrials.includes(trialNum)) return;
                
                this.completedTrials.push(trialNum);
                this.spiritualState.trialsCompleted = this.completedTrials.length;
                
                // Update dharma stage indicator
                const stageIndicator = document.querySelector(`[data-stage="${trialNum}"]`);
                if (stageIndicator) {
                    stageIndicator.classList.remove('active', 'locked');
                    stageIndicator.classList.add('achieved');
                    stageIndicator.innerHTML = '<div>✓</div>';
                }
                
                // Calculate spiritual rewards
                const timeBonus = Math.max(0, 500 - Math.floor((Date.now() - this.startTime) / 1000));
                const hintPenalty = this.hintsUsed * 15;
                const baseReward = 150;
                const totalReward = baseReward + timeBonus - hintPenalty;
                
                this.spiritualState.karma += totalReward;
                this.spiritualState.wisdom += 50;
                this.spiritualState.attunement = Math.min(100, this.spiritualState.attunement + 25);
                
                // Update consciousness level
                const consciousnessLevels = ['Seeker', 'Apprentice', 'Adept', 'Master'];
                this.spiritualState.consciousness = consciousnessLevels[this.completedTrials.length];
                
                // Add sacred artifacts
                const artifacts = [
                    '🎵 Harmonic Resonance Crystal - Attunes you to cosmic frequencies',
                    '⬢ Sacred Geometry Codex - Reveals the blueprints of creation', 
                    '👑 Chakra Awakening Crown - Maintains perfect energy alignment'
                ];
                this.artifacts.push(artifacts[trialNum - 1]);
                
                this.updateAllDisplays();
                
                const trialNames = ['Harmonic Resonance', 'Sacred Geometry', 'Chakra Awakening'];
                this.showDivineMessage(
                    `🌟 Trial ${trialNum} Mastered: ${trialNames[trialNum - 1]}! You have gained ${totalReward} karma and expanded your consciousness.`,
                    'success'
                );
                
                if (trialNum < 3) {
                    setTimeout(() => this.advanceToTrial(trialNum + 1), 3000);
                } else {
                    setTimeout(() => this.achieveFinalEnlightenment(), 3000);
                }
            }
            
            advanceToTrial(trialNum) {
                // Hide current trial
                document.querySelector('.wisdom-trial.active').classList.remove('active');
                
                // Show next trial
                const nextTrial = document.getElementById(`trial-${trialNum}`);
                if (nextTrial) {
                    nextTrial.classList.add('active');
                    this.currentTrial = trialNum;
                    
                    // Update stage indicator
                    const stageIndicator = document.querySelector(`[data-stage="${trialNum}"]`);
                    if (stageIndicator) {
                        stageIndicator.classList.remove('locked');
                        stageIndicator.classList.add('active');
                    }
                    
                    // Scroll to new trial
                    nextTrial.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    this.showDivineMessage(
                        `The path deepens... Trial ${trialNum} awaits your wisdom.`,
                        'wisdom'
                    );
                }
            }
            
            achieveFinalEnlightenment() {
                // Clear cosmic timer
                if (this.cosmicTimer) {
                    clearInterval(this.cosmicTimer);
                }
                
                // Massive final rewards
                this.spiritualState.karma += 1000;
                this.spiritualState.wisdom += 200;
                this.spiritualState.attunement = 100;
                this.artifacts.push('🌳 Banyan\'s Eternal Blessing - The complete wisdom of ages');
                
                this.updateAllDisplays();
                
                this.showDivineMessage(
                    '🌳 THE GREAT BANYAN AWAKENS! You have achieved perfect mastery of the cosmic principles. The eternal wisdom flows through your being...',
                    'success'
                );
                
                setTimeout(() => {
                    this.showEnlightenmentScreen();
                }, 4000);
            }
            
            showEnlightenmentScreen() {
                const journeyCanvas = document.querySelector('.journey-canvas');
                if (!journeyCanvas) return;
                
                journeyCanvas.innerHTML = `
                    <div style="text-align: center; padding: var(--space-2xl);">
                        <div style="margin-bottom: var(--space-xl);">
                            <div style="font-size: 4rem; margin-bottom: var(--space-md);">🌳</div>
                            <h2 style="font-family: var(--font-title); font-size: 3.5rem; color: var(--color-primary-glow); margin-bottom: var(--space-lg);">
                                The Banyan's Eternal Gratitude
                            </h2>
                        </div>
                        
                        <div style="font-family: var(--font-story); font-size: 1.4rem; line-height: 1.8; margin-bottom: var(--space-2xl); max-width: 900px; margin-left: auto; margin-right: auto;">
                            <p style="margin-bottom: var(--space-lg);">As the final chakra blazes with divine light, the Great Banyan straightens to its full cosmic majesty. Its roots reach deeper into the eternal principles while its crown touches the very source of consciousness.</p>
                            
                            <p style="margin: var(--space-xl) 0; color: var(--color-primary-glow); font-weight: 600; font-size: 1.6rem;">
                                "You have achieved what few souls dare attempt and fewer still complete. You are now one with the eternal rhythm of existence."
                            </p>
                            
                            <p style="margin-bottom: var(--space-lg);">The tree's ancient wisdom flows into your being—understanding of harmonic frequencies that heal reality itself, sacred geometries that unlock the blueprints of creation, and chakra mastery that bridges the finite and infinite.</p>
                            
                            <p style="color: var(--color-cosmic); font-weight: 600;">You are transformed. You are awakened. Your journey into the deeper mysteries of Samsara now begins...</p>
                        </div>
                        
                        <div style="display: flex; gap: var(--space-lg); justify-content: center; flex-wrap: wrap; margin-top: var(--space-2xl);">
                            <button class="cosmic-button btn-primary" onclick="continueCosmicJourney()" style="font-size: 1.2rem; padding: var(--space-md) var(--space-xl);">
                                🚀 Continue Cosmic Journey
                            </button>
                            <button class="cosmic-button btn-wisdom" onclick="enterEternalMeditation()" style="font-size: 1.2rem; padding: var(--space-md) var(--space-xl);">
                                🧘 Eternal Meditation
                            </button>
                            <button class="cosmic-button btn-secondary" onclick="shareEnlightenment()" style="font-size: 1.2rem; padding: var(--space-md) var(--space-xl);">
                                📜 Share Enlightenment
                            </button>
                        </div>
                        
                        <div style="margin-top: var(--space-2xl); padding: var(--space-xl); background: rgba(139, 92, 246, 0.1); border-radius: var(--border-radius-large); border: 2px solid var(--color-cosmic);">
                            <h3 style="color: var(--color-cosmic); margin-bottom: var(--space-md); font-family: var(--font-title);">🏆 Enlightenment Achievements</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-md); text-align: left;">
                                <div>✨ Master of Harmonic Resonance</div>
                                <div>⬢ Sage of Sacred Geometry</div>
                                <div>👑 Adept of Chakra Awakening</div>
                                <div>🌳 Bearer of Banyan's Blessing</div>
                                <div>🎯 Perfect Cosmic Attunement</div>
                                <div>🧘 Transcendent Consciousness</div>
                                <div>📿 Keeper of Eternal Wisdom</div>
                                <div>🕉️ One with Universal Truth</div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // ===== UI UPDATE METHODS =====
            updateAllDisplays() {
                // Update spiritual metrics
                document.getElementById('karma-metric').textContent = this.spiritualState.karma;
                document.getElementById('wisdom-metric').textContent = this.spiritualState.wisdom;
                document.getElementById('trials-metric').textContent = `${this.spiritualState.trialsCompleted}/3`;
                document.getElementById('consciousness-metric').textContent = this.spiritualState.consciousness;
                document.getElementById('attunement-metric').textContent = `${this.spiritualState.attunement}%`;
                
                // Update artifacts
                this.updateArtifactsDisplay();
            }
            
            updateArtifactsDisplay() {
                const artifactsCollection = document.getElementById('artifacts-collection');
                if (!artifactsCollection) return;
                
                if (this.artifacts.length === 0) {
                    artifactsCollection.innerHTML = '<div class="artifact-empty">The artifacts of wisdom await your mastery of the trials...</div>';
                } else {
                    artifactsCollection.innerHTML = this.artifacts.map(artifact => {
                        const [icon, ...nameParts] = artifact.split(' ');
                        const name = nameParts.join(' ');
                        return `
                            <div class="artifact-item">
                                <div class="artifact-icon">${icon}</div>
                                <div class="artifact-name">${name}</div>
                            </div>
                        `;
                    }).join('');
                }
            }
            
            showDivineMessage(message, type = 'wisdom') {
                const messageElement = document.getElementById('divine-message');
                if (!messageElement) return;
                
                messageElement.textContent = message;
                messageElement.className = `divine-message message-${type} manifest`;
                
                setTimeout(() => {
                    messageElement.classList.remove('manifest');
                }, 5000);
            }
            
            showCosmicNotification(message, type = 'wisdom') {
                const container = document.getElementById('cosmic-notifications');
                if (!container) return;
                
                const notification = document.createElement('div');
                notification.className = `divine-notification ${type}`;
                
                const icons = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle',
                    wisdom: 'fas fa-star',
                    warning: 'fas fa-exclamation-triangle'
                };
                
                notification.innerHTML = `
                    <div class="notification-content">
                        <i class="notification-icon ${icons[type] || icons.wisdom}"></i>
                        <div class="notification-text">${message}</div>
                    </div>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => notification.classList.add('manifest'), 100);
                
                setTimeout(() => {
                    notification.classList.remove('manifest');
                    setTimeout(() => notification.remove(), 600);
                }, 6000);
            }
            
            preserveJourney() {
                const journeyData = {
                    currentTrial: this.currentTrial,
                    completedTrials: this.completedTrials,
                    spiritualState: this.spiritualState,
                    harmonics: this.harmonics,
                    geometryPattern: this.geometryPattern,
                    chakraSequence: this.chakraSequence,
                    artifacts: this.artifacts,
                    timestamp: new Date().toISOString()
                };
                
                try {
                    localStorage.setItem('samsaraSagaJourney', JSON.stringify(journeyData));
                    this.showCosmicNotification('Your spiritual journey has been preserved in the cosmic records!', 'success');
                } catch (error) {
                    this.showCosmicNotification('Failed to preserve journey. The cosmic forces resist...', 'error');
                }
            }
            
            showWelcomeMessage() {
                setTimeout(() => {
                    this.showCosmicNotification(
                        '🌟 Welcome to the Great Banyan\'s Trial. Three sacred challenges await your wisdom.',
                        'wisdom'
                    );
                }, 1000);
            }
            
            startCosmicBackgroundMusic() {
                // In a real implementation, this would start ambient cosmic music
                console.log('🎵 Cosmic background harmonics initiated...');
            }
        }
        
        // ===== GLOBAL FUNCTIONS FOR UI INTERACTION =====
        let cosmicEngine;
        
        // Initialize the cosmic experience
        document.addEventListener('DOMContentLoaded', () => {
            try {
                cosmicEngine = new SamsaraSagaEngine();
                console.log('🌟 Samsara Saga - Premium Philosophical Adventure initialized!');
            } catch (error) {
                console.error('Failed to initialize cosmic experience:', error);
                showGenericNotification('Failed to initialize. Please refresh to begin your journey.', 'error');
            }
        });
        
        // Control functions
        function validateCurrentTrial() {
            if (!cosmicEngine) return;
            
            switch (cosmicEngine.currentTrial) {
                case 1:
                    cosmicEngine.checkHarmonicResonance();
                    if (!cosmicEngine.completedTrials.includes(1)) {
                        cosmicEngine.showDivineMessage(
                            'The cosmic frequencies are not yet aligned. Seek the sacred ratio: 108°, 144°, 180°.',
                            'warning'
                        );
                    }
                    break;
                case 2:
                    if (cosmicEngine.geometryPattern.length === 0) {
                        cosmicEngine.showDivineMessage(
                            'Begin with the center node, then allow the Flower of Life to unfold naturally.',
                            'wisdom'
                        );
                    } else {
                        cosmicEngine.showDivineMessage(
                            `Sacred geometry progress: ${cosmicEngine.geometryPattern.length}/${cosmicEngine.flowerOfLifeSequence.length} nodes awakened.`,
                            'wisdom'
                        );
                    }
                    break;
                case 3:
                    if (cosmicEngine.chakraSequence.length === 0) {
                        cosmicEngine.showDivineMessage(
                            'Begin with Muladhara (Root) and ascend mindfully. Wait for the cosmic pulse.',
                            'wisdom'
                        );
                    } else {
                        cosmicEngine.showDivineMessage(
                            `Chakra awakening progress: ${cosmicEngine.chakraSequence.length}/7 energy centers activated.`,
                            'wisdom'
                        );
                    }
                    break;
            }
        }
        
        function receiveCosmicWisdom() {
            if (!cosmicEngine) return;
            
            cosmicEngine.hintsUsed++;
            
            const wisdomTeachings = {
                1: "The sacred frequencies mirror the cosmic order. Sattva (108°) represents pure consciousness, Rajas (144°) dynamic action, Tamas (180°) potential energy. Listen for the harmony that connects all existence.",
                2: "The Flower of Life begins with the central seed and unfolds in spirals. Start at the heart (center) and move outward in the sacred sequence. Each node connects to the universal pattern of creation.",
                3: "The chakras awaken from earth to sky: Muladhara (Root) → Svadhisthana (Sacral) → Manipura (Solar) → Anahata (Heart) → Vishuddha (Throat) → Ajna (Third Eye) → Sahasrara (Crown). Feel the cosmic pulse before each activation."
            };
            
            cosmicEngine.showDivineMessage(
                `Cosmic Wisdom: ${wisdomTeachings[cosmicEngine.currentTrial]}`,
                'wisdom'
            );
            
            // Small karma adjustment for seeking guidance
            cosmicEngine.spiritualState.karma = Math.max(0, cosmicEngine.spiritualState.karma - 10);
            cosmicEngine.updateAllDisplays();
        }
        
        function resetCurrentTrial() {
            if (!cosmicEngine) return;
            
            switch (cosmicEngine.currentTrial) {
                case 1:
                    // Reset to random harmonic positions
                    for (let i = 1; i <= 3; i++) {
                        const slider = document.getElementById(`freq-${i}`);
                        if (slider) {
                            const randomAngle = Math.floor(Math.random() * 360);
                            slider.value = randomAngle;
                            cosmicEngine.updateFrequency(i);
                        }
                    }
                    break;
                case 2:
                    cosmicEngine.resetGeometryPattern();
                    break;
                case 3:
                    cosmicEngine.resetChakraSequence();
                    break;
            }
            
            cosmicEngine.showDivineMessage(
                'The trial resets, offering a fresh path to enlightenment. Begin anew with deeper understanding.',
                'wisdom'
            );
        }
        
        function transcendToNextRealm() {
            if (confirm('🚨 Transcend beyond this sacred trial? You will miss the profound spiritual rewards and cosmic attunement. Continue to the next realm?')) {
                continueCosmicJourney();
            }
        }
        
        function preserveJourney() {
            if (cosmicEngine) {
                cosmicEngine.preserveJourney();
            }
        }
        
        function enterDeepMeditation() {
            if (!cosmicEngine) return;
            
            cosmicEngine.spiritualState.karma += 25;
            cosmicEngine.spiritualState.wisdom += 10;
            cosmicEngine.spiritualState.attunement = Math.min(100, cosmicEngine.spiritualState.attunement + 3);
            cosmicEngine.updateAllDisplays();
            cosmicEngine.showCosmicNotification(
                'Through deep meditation, your consciousness expands and cosmic clarity increases...',
                'success'
            );
        }
        
        function contemplateWisdom() {
            if (!cosmicEngine) return;
            
            const wisdomReflections = [
                "In the silence between thoughts, the universe reveals its secrets.",
                "Every action creates ripples through the cosmic ocean of consciousness.",
                "The path to enlightenment is not a destination, but a way of being.",
                "When you align with dharma, the entire universe conspires to assist you.",
                "True wisdom lies not in knowing, but in being one with the known."
            ];
            
            const randomWisdom = wisdomReflections[Math.floor(Math.random() * wisdomReflections.length)];
            cosmicEngine.showDivineMessage(`Contemplation: "${randomWisdom}"`, 'wisdom');
            
            cosmicEngine.spiritualState.wisdom += 5;
            cosmicEngine.updateAllDisplays();
        }
        
        // Completion screen functions
        function continueCosmicJourney() {
            if (cosmicEngine) {
                cosmicEngine.showCosmicNotification(
                    'Your cosmic journey continues beyond the Banyan\'s realm into infinite mysteries...',
                    'success'
                );
            }
        }
        
        function enterEternalMeditation() {
            if (cosmicEngine) {
                cosmicEngine.showCosmicNotification(
                    'You enter eternal meditation, becoming one with the cosmic consciousness itself...',
                    'wisdom'
                );
            }
        }
        
        function shareEnlightenment() {
            if (cosmicEngine) {
                cosmicEngine.showCosmicNotification(
                    'Your enlightenment becomes a beacon, inspiring countless souls on their spiritual journey...',
                    'success'
                );
            }
        }
        
        // Generic notification for errors
        function showGenericNotification(message, type) {
            console.log(`Notification (${type}): ${message}`);
        }
        
        // Prevent auto-refresh issues
        window.addEventListener('beforeunload', () => {
            if (cosmicEngine) {
                cosmicEngine.preserveJourney();
            }
        });
        
        // No automatic refresh mechanisms
        console.log('🌟 Premium Samsara Saga - Philosophical Adventure Engine ready!');
        console.log('🚫 Auto-refresh permanently disabled. Manual preservation system active.');
    </script>
</body>
</html>
